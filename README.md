# TikToken — TikTok Live Like Miner Dashboard

## Описание
TikToken — это дашборд-приложение для стримов TikTok, которое в реальном времени собирает лайки зрителей через TikTok-Live-Connector, ведёт статистику по каждому пользователю и отображает топ-5 «майнеров» лайков. Все данные хранятся в локальной базе (data.json), полностью совместимой по структуре с Firebase (можно легко мигрировать на Firestore).

### Основные фичи
- **Сбор лайков**: лайки с TikTok Live собираются через TikTok-Live-Connector (userId, nickname, avatar, количество лайков).
- **Локальная база**: все данные хранятся в data.json (userId, nickname, avatar, likes).
- **Глобальная статистика**: общее количество лайков (TOKENS MINED), общее количество уникальных пользователей (TOTAL MINERS).
- **Лидерборд**: топ-5 пользователей по количеству лайков, с аватаркой, ником и счётчиком.
- **UI**: адаптивный фронт с эффектом "космического" фона, обновление данных без перезагрузки.
- **Мониторинг базы**: доступ к базе через отдельный эндпоинт (`/db`).
- **Лёгкая миграция на Firebase**: структура базы полностью совместима, можно заменить хранилище на Firestore.

---

## Быстрый старт

1. **Установить зависимости**
   ```bash
   npm install express tiktok-live-connector
   ```

2. **Запустить сервер**
   ```bash
   node server.js
   ```

3. **Открыть приложение**
   - Перейти в браузере на [http://localhost:3030](http://localhost:3030)
   - Для мониторинга базы: [http://localhost:3030/db](http://localhost:3030/db)

4. **Настроить TikTok-юзернейм**
   - По умолчанию используется `digital.n0mad`. Чтобы сменить:
     - Либо изменить переменную окружения `TIKTOK_USERNAME`
     - Либо отредактировать строку в server.js

---

## Структура проекта

- `server.js` — Node.js сервер, собирает лайки, ведёт базу, отдаёт API и фронт.
- `data.json` — локальная база пользователей и лайков (создаётся автоматически).
- `index.html` — основной UI приложения.
- `styles.css` — стили, включая космический фон и оформление лидерборда.
- `orb.js` — логика фронта: обновление статистики, отрисовка лидерборда, работа с API.
- `nebula.js` — эффект "космического" фона.

---

## API

- `GET /api/stats` — статистика для фронта
  - `totalLikes` — общее количество лайков
  - `totalMiners` — количество уникальных пользователей
  - `leaderboard` — топ-5 пользователей (userId, nickname, avatar, likes)

- `GET /db` — полная база в формате JSON (для мониторинга или бэкапа)

---

## Как работает обработка лайков
- Сервер подключается к TikTok Live через TikTok-Live-Connector.
- При каждом событии "like":
  - Если userId не в базе — добавляет пользователя (с ником и аватаркой).
  - Обновляет nickname и avatar при каждом новом лайке.
  - Увеличивает счётчик лайков.
  - Сохраняет базу на диск.
- Фронт периодически (раз в 2 секунды) запрашивает `/api/stats` и обновляет UI.

---

## Особенности UI
- Лидерборд всегда занимает место под 5 позиций (даже если пользователей меньше).
- Все элементы выровнены по одной линии: номер — аватарка — ник — количество.
- Космический фон и "стеклянные" карточки.
- UI не скачет при появлении новых пользователей.

---

## Как использовать/развивать дальше
- Можно легко мигрировать базу на Firestore/Firebase (структура полностью совместима).
- Можно добавить новые метрики: история лайков, фильтрация по времени, сброс/экспорт базы.
- Можно расширить API для интеграции с другими сервисами или ботами.
- Можно подключить WebSocket для мгновенного обновления UI.

---

## Важно
- Сервер должен быть запущен, пока идёт стрим, чтобы лайки не терялись.
- Если сервер выключен — лайки, поставленные в этот момент, не попадут в базу.

---

## Авторство и лицензия
- Автор: digital.n0mad (и твой ник, если хочешь)
- Используется библиотека [TikTok-Live-Connector](https://github.com/zerodytrash/TikTok-Live-Connector)
- Для любых целей, дорабатывай и кастомизируй под себя!
